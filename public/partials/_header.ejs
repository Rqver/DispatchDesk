<header class="bg-white dark:bg-gray-800 shadow sticky top-0 z-40">
    <div class="container mx-auto px-4 py-6 flex justify-between items-center">
        <h1 class="text-3xl font-bold text-cyan-500 tracking-tight">
            <a href="/">Dispatch Desk</a>
        </h1>
        <div class="sm:hidden flex items-center gap-4">
            <button id="mobileMenuToggle" aria-label="Toggle Menu" class="text-gray-500 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
            </button>
        </div>
        <div class="hidden sm:flex items-center gap-4">
            <nav id="desktopNav" class="flex flex-wrap justify-center items-center gap-4 text-sm sm:text-base">
                <a href="/" class="font-semibold text-cyan-500 dark:text-cyan-400">Home</a>
                <div id="featured-categories" data-slot="featured_categories_nav">
                    <%- include('_category-nav', { featuredCategories }) %>
                </div>
                <button id="openSearchDesktop" aria-label="Search" class="text-gray-500 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z" />
                    </svg>
                </button>
            </nav>
            <button id="darkModeToggle" aria-label="Toggle Dark Mode" class="text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m8.66-8.66h-1M4.34 12H3m15.364 4.95l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M12 5a7 7 0 100 14 7 7 0 000-14z"/>
                </svg>
            </button>
        </div>
    </div>
    <nav id="mobileNav" class="sm:hidden hidden px-4 pb-4">
        <a href="/" class="block py-2 font-semibold text-cyan-500 dark:text-cyan-400">Home</a>
        <% if (locals.featuredCategories) { %>
            <% Object.values(featuredCategories).forEach(category => { %>
                <% if (category) { %>
                    <a href="/category/<%= category.slug %>" class="block py-2 text-gray-600 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400 transition"><%= category.name %></a>
                <% } %>
            <% }) %>
        <% } %>
        <button id="openSearchMobile" class="block w-full text-left py-2 text-gray-500 dark:text-gray-300 hover:text-cyan-500 dark:hover:text-cyan-400 transition">Search</button>
        <button id="darkModeToggleMobile" aria-label="Toggle Dark Mode" class="block w-full text-left py-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 transition">Toggle Dark Mode</button>
    </nav>
    <div id="breaking-bar" data-slot="breakingBar">
        <%- include('../partials/_breaking-bar', { breakingBar }) %>
    </div>
</header>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const toggleDarkMode = () => {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
        };

        const desktopToggle = document.getElementById('darkModeToggle');
        const mobileToggle = document.getElementById('darkModeToggleMobile');
        if (desktopToggle) desktopToggle.addEventListener('click', toggleDarkMode);
        if (mobileToggle) mobileToggle.addEventListener('click', toggleDarkMode);

        const mobileMenuButton = document.getElementById('mobileMenuToggle');
        const mobileNavElement = document.getElementById('mobileNav');
        if (mobileMenuButton && mobileNavElement) {
            mobileMenuButton.addEventListener('click', function () {
                mobileNavElement.classList.toggle('hidden');
            });
        }
    })
</script>

